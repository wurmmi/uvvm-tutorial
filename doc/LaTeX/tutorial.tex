\section{Tutorial}

This tutorial guides you through the example project that was developed.

%------------------------------------------------------------------------------
\subsection{Device Under Verification (DUV)}

The Device Under Verification (DUV) is a very basic LED driver, that has some additional accessible memory inside. The interface this memory uses, is compile-time configurable between an AXIlite, or an Avalon MM protocol.

\includepicture[0.6][0]{DUV Block Diagram}{img/draw-io/duv}

%------------------------------------------------------------------------------
\subsection{Testbench Architecture}

The architecture of the demo testbench is shown in the block diagram below.

\includepicture[0.8][0]{Testbench Block Diagram}{img/draw-io/tb-architecture}

The testbench instantiates a test harness and runs the actual test sequences. It further generates clock and reset signals for the DUV.
The test harness instantiates several VVCs and the DUV. Dotted lines in the block diagram represent connections, that exist within the UVVM framework and don't need to be connected explicitly.

%------------------------------------------------------------------------------
\subsection{Hands-On}

At this point, we have enough information and are ready to start working with the example project.

%------------------------------------------------------------------------------
\subsubsection{Project environment}

Let's start with getting to know the projects' environment setup. \\
In this part we will compile the UVVM library and the DUV, and run the simulation of our first example testbench!

\begin{enumerate}
      \item Open the example-tb folder in the repository.
            You will find a Makefile, that's used to simplify the usage of this project. It builds an abstraction layer to the underlaying ModelSim commands.
      \item \texttt{make help} is your friend. \\
            It shows all the actions, that this project provides.
      \item Call \texttt{make ip}. \\
            This compiles all the VHDL files, that belong to the DUV.\\
            Call this target, whenever your DUVs RTL code changed and you want to simulate it.
      \item Call \texttt{make uvvm}. \\
            This compiles several required components of the UVVM library. \\
            That only needs to be done once.
      \item Call \texttt{make test}. \\
            This compiles the testbench files and runs the simulation.
      \item Read through the log that was generated.\\
            The console output was also logged into the file \textit{example-tb/build/log/sim\_testbench.log}.
\end{enumerate}

%------------------------------------------------------------------------------
\subsubsection{Read through the AXI test sequence}

The DUV includes a memory that can be read and written through an AXI memory mapped interface. In this part, we will read through the existing AXI test sequence.

\begin{enumerate}
      \item Open the \href{../../example-tb/src/tb/sequences/axi\_reg\_seq\_pkg.vhd} {AXI register test sequence file}.\\
            (example-tb/src/tb/sequences/axi\_reg\_seq\_pkg.vhd).
      \item Check out the main AXI VVC functions.
            \begin{itemize}
                  \item \texttt{axilite\_write()}\\
                        Writes data to a given address.\\
                        This function is non-blocking. It schedules the action in the UVVM sequencer queue.
                  \item \texttt{axilite\_check()}\\
                        Reads data from a given address and compares with the given value.\\
                        This function is non-blocking. It schedules the action in the UVVM sequencer queue.
                  \item \texttt{await\_completion()}\\
                        This function waits on a given VVC to complete its action queue. In case the VVC exceeds the given timeout, an error is raised.\\
            \end{itemize}
      \item Try to write a register that is read-only
            \begin{itemize}
                  \item Writing to a read-only register is not allowed. Thus, we expect the call \texttt{axilite\_write()} to fail and raise a \texttt{TB\_FAILURE}.
                  \item We need to tell UVVM that we are expecting this failure. By default, the testbench execution is stopped after the occurance of a single failure.
                  \item Two functions need to be called to set expected failures. These are \texttt{increment\_expected\_alerts()} and \texttt{set\_alert\_stop\_limit()}.
            \end{itemize}
\end{enumerate}

%------------------------------------------------------------------------------
\subsubsection{Write a memory test sequence}

In this part, we will write a test sequence that verifies the correct functionality of this memory.

\begin{enumerate}
      \item Again, open the \href{../../example-tb/src/tb/sequences/axi\_reg\_seq\_pkg.vhd} {AXI register test sequence file}.\\
            (example-tb/src/tb/sequences/axi\_reg\_seq\_pkg.vhd).
      \item Scroll to the end of the file, where you will find a ``TODO'' section.
\end{enumerate}
